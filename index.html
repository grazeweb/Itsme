<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ITSME ‚Ä¢ CubeCraft Queen</title>
<link rel="icon" type="image/png" href="https://em-content.zobj.net/source/microsoft-teams/337/heart-with-arrow_1f498.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300..700&family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
<script src="https://unpkg.com/lucide@latest"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<style>
:root {
  --bg: #dff6fb;
  --text: #072227;
  --primary: #00a3c4;
  --primary-dark: #00829c;
}
* { box-sizing: border-box; }
body { margin:0; font-family:'Nunito',sans-serif; background: linear-gradient(180deg,var(--bg) 0%,#e8fbff 100%); color: var(--text); min-height:100vh; padding:20px; }
h1,h2,h3,h4 { font-family:'Fredoka',sans-serif; }

.container { max-width:1100px; margin:0 auto; display:flex; flex-direction:column; gap:30px; }
header { background: rgba(255,255,255,0.8); backdrop-filter:blur(10px); border:2px solid rgba(255,255,255,0.5); border-radius:20px; padding:16px 24px; display:flex; align-items:center; justify-content:space-between; box-shadow:0 4px 10px rgba(0,0,0,0.05); }
.logo-area { display:flex; gap:16px; align-items:center; }
.logo-box { width:60px;height:60px; background: linear-gradient(135deg,#4facfe 0%,#00f2fe 100%); border-radius:14px; display:flex; align-items:center; justify-content:center; color:white; font-weight:900; font-size:20px; transform:rotate(-3deg); border:4px solid white; box-shadow:0 8px 15px rgba(0,0,0,0.1); }
.main-grid { display:grid; grid-template-columns:1fr 360px; gap:30px; }
@media(max-width:900px){.main-grid{grid-template-columns:1fr;}}

.card-3d{background:white; border-radius:24px; padding:24px; border:2px solid rgba(255,255,255,0.5); box-shadow:0 12px 0 rgba(0,0,0,0.05),0 20px 30px rgba(0,0,0,0.05);}
.btn-3d{border:none; cursor:pointer; font-family:'Fredoka',sans-serif; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-radius:12px; padding:12px 24px; position:relative; transition:transform 0.1s; display:inline-flex; align-items:center; gap:8px; justify-content:center;}
.btn-3d:active{transform:translateY(4px); box-shadow:none !important;}
.btn-primary{background:var(--primary); color:white; box-shadow:0 6px 0 var(--primary-dark);}
.btn-white{background:white;color:var(--text);box-shadow:0 6px 0 #e5e7eb; border:1px solid #f3f4f6;}
.btn-discord{background:white;color:#5865F2; box-shadow:0 6px 0 rgba(0,0,0,0.1);}

.profile-hero{background: linear-gradient(180deg,#00c6ff 0%,#7fe3f8 100%); min-height:400px; border-radius:30px; padding:40px; color:white; position:relative; overflow:hidden; box-shadow:0 12px 0 rgba(0,0,0,0.1);}
.profile-content{position:relative; z-index:10;}
.avatar-box{width:140px;height:140px; background:rgba(0,0,0,0.1); border-radius:24px; display:flex; align-items:center; justify-content:center; font-size:60px; border:4px solid rgba(255,255,255,0.2); backdrop-filter:blur(4px);}
.pill{padding:6px 12px; border-radius:10px; font-weight:700; font-size:14px; display:inline-block; border:2px solid rgba(255,255,255,0.2);}
.pill.online{background:#22c55e;color:white;border-color:#4ade80;}
.pill.offline{background:rgba(0,0,0,0.2);color:rgba(255,255,255,0.8);}
.stat-box{background: rgba(0,0,0,0.1); border-radius:16px; padding:16px; text-align:center; border:2px solid rgba(255,255,255,0.1);}

.discord-card{margin-top:30px; background:#5865F2; border-radius:24px; padding:24px; color:white; box-shadow:0 10px 0 rgba(0,0,0,0.15); display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:20px; position:relative; overflow:hidden;}

.sidebar-section{display:flex; flex-direction:column; gap:24px;}
.stat-row{display:flex; align-items:center; gap:16px; padding:12px; border-radius:16px; transition:background 0.2s; cursor:pointer;}
.stat-row:hover{background:#f8fafc;}
.stat-icon{width:48px; height:48px; border-radius:12px; display:flex; align-items:center; justify-content:center; color:white;}
.bf-card{background: linear-gradient(135deg,#ff9a9e 0%,#fecfef 99%,#fecfef 100%); border-radius:24px; padding:24px; box-shadow:0 10px 0 rgba(255,100,150,0.2); color:#861e3e;}

.modal-overlay{position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.6); backdrop-filter:blur(6px); display:none; align-items:center; justify-content:center; z-index:1000;}
.modal-overlay.open{display:flex !important;}
.modal-content{background:white; width:90%; max-width:500px; border-radius:28px; box-shadow:0 25px 70px rgba(0,0,0,0.45), 0 10px 30px rgba(0,163,196,0.2), inset 0 1px 0 rgba(255,255,255,0.6); overflow:hidden; animation:popIn 0.3s cubic-bezier(0.175,0.885,0.32,1.275); border:1px solid rgba(255,255,255,0.8);}
@keyframes popIn{from{transform:scale(0.85) translateY(20px);opacity:0;}to{transform:scale(1) translateY(0);opacity:1;}}
.modal-header{background:linear-gradient(135deg, #1e293b 0%, #0f172a 100%); padding:24px; color:white; display:flex; justify-content:space-between; align-items:center; box-shadow:0 4px 20px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.1);}
.modal-header h3{font-size:20px; font-weight:700;}
.modal-body{padding:28px; background:#f9fafb;}
.input-group{margin-bottom:16px;}
.input-group label{display:block;font-size:12px;font-weight:700;margin-bottom:6px;color:#64748b;}
.form-input{width:100%;padding:12px;border:2px solid #e2e8f0;border-radius:12px;font-family:'Nunito',sans-serif;font-weight:600;outline:none;}
.form-input:focus{border-color:var(--primary);}
.form-input::-webkit-scrollbar{width:6px;}
.form-input::-webkit-scrollbar-track{background:#f1f5f9; border-radius:10px;}
.form-input::-webkit-scrollbar-thumb{background:#cbd5e1; border-radius:10px;}
.form-input::-webkit-scrollbar-thumb:hover{background:#94a3b8;}
select.form-input{appearance:none; background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2364748b' d='M6 9L1 4h10z'/%3E%3C/svg%3E"); background-repeat:no-repeat; background-position:right 12px center; padding-right:36px; cursor:pointer; transition:all 0.2s; box-shadow:0 4px 0 rgba(0,0,0,0.08);}
select.form-input:hover{border-color:var(--primary); box-shadow:0 6px 12px rgba(0,163,196,0.15);}
select.form-input:active{box-shadow:0 2px 4px rgba(0,0,0,0.1);}
select.form-input option{padding:12px; background:white; color:var(--text);}
.modal-content{border:2px solid rgba(255,255,255,0.5); box-shadow:0 20px 60px rgba(0,0,0,0.4), 0 0 40px rgba(0,163,196,0.1);}
.modal-header{box-shadow:0 4px 12px rgba(0,0,0,0.15);}
.hidden{display:none !important;}
.btn-youtube{background:#ff0000; color:white; box-shadow:0 6px 0 #cc0000; text-decoration:none !important;}
.itsmee{width:190px;}
.rank-icon{display:inline-block; margin-right:6px; font-weight:900;}


.modal {
    overflow: hidden !important;
}

.modal-body {
    max-height: 400px;
    overflow-y: auto;
}


</style>
</head>
<body>
<div class="container">
<header>
  <div class="logo-area">
    <div class="logo-box">MC</div>
    <div>
      <h1 style="margin:0; font-size: 22px;">ITSME ‚Ä¢ CubeCraft Queen</h1>
      <span style="color:#64748b; font-size:14px; font-weight:700;">Personal gaming profile</span>
    </div>
  </div>
  <button onclick="openAdmin()" class="btn-3d btn-white"><i data-lucide="settings" width="16"></i> Admin</button>
</header>

<div class="main-grid">
  <section>
    <div class="profile-hero">
      <div class="profile-content">
        <div style="display:flex; gap:30px; flex-wrap:wrap; align-items:flex-start;">
          <div class="avatar-box" id="disp_avatar"><img src="https://i.postimg.cc/V5tynQDS/download.png" class="itsmee"></div>
          <div style="flex:1;">
            <h1 style="margin:0; font-size:36px; text-shadow:0 2px 0 rgba(0,0,0,0.1);" id="disp_name">Itsme</h1>
            <p style="margin:6px 0 16px 0; font-weight:700; opacity:0.8;" id="disp_tag">CubeCraft ‚Ä¢ Level 32</p>
            <div style="display:flex; gap:10px; flex-wrap:wrap;">
              <div class="pill offline" id="online_pill">Offline</div>
              <div class="pill" style="background: rgba(0,0,0,0.2);">Fav: <span id="disp_fav">CTF</span></div>
              <div class="pill" id="rank_pill" style="background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color:#78350f; border:2px solid #fcd34d; box-shadow:0 4px 12px rgba(251, 191, 36, 0.3);">Rank: <span id="disp_rank">‚ñ≤ Gold</span></div>
            </div>
            <div style="display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-top:24px;">
              <div class="stat-box"><div style="font-size:10px; text-transform:uppercase; font-weight:800; opacity:0.7;">Wins</div><div style="font-size:24px; font-weight:900;" id="disp_wins">892</div></div>
              <div class="stat-box"><div style="font-size:10px; text-transform:uppercase; font-weight:800; opacity:0.7;">K/D</div><div style="font-size:24px; font-weight:900;" id="disp_kd">2.35</div></div>
              <div class="stat-box"><div style="font-size:10px; text-transform:uppercase; font-weight:800; opacity:0.7;">Streak</div><div style="font-size:24px; font-weight:900;" id="disp_streak">12</div></div>
            </div>
          </div>
        </div>

        <div style="margin-top:30px; background:white; border-radius:16px; padding:20px; color:#1e293b; display:flex; gap:12px; overflow-x:auto;">
          <div style="flex:1; display:flex; align-items:center; gap:12px; padding:10px; background:#f8fafc; border-radius:12px;">
            <div><div style="font-weight:800; font-size:14px;">EggWars Master</div><div style="font-size:10px; color:#94a3b8; font-weight:700;">ACHIEVEMENT</div></div>
            <div style="margin-left:auto; font-size:20px;">üèÜ</div>
          </div>
          <div style="flex:1; display:flex; align-items:center; gap:12px; padding:10px; background:#f8fafc; border-radius:12px;">
            <div><div style="font-weight:800; font-size:14px;">Clutch Queen</div><div style="font-size:10px; color:#94a3b8; font-weight:700;">ACHIEVEMENT</div></div>
            <div style="margin-left:auto; font-size:20px;">üèÜ</div>
          </div>
        </div>

        <div style="display:flex; gap:12px; margin-top:20px;">
          <button class="btn-3d btn-white" style="flex:1;" onclick="openFullStats()">Full Stats</button>
          <button class="btn-3d btn-primary" style="flex:1; background:#0e7490;" onclick="openClips()">Watch Best Clip</button>
        </div>
      </div>
      <div style="position:absolute; top:-50px; right:-50px; width:300px; height:300px; background:radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%); border-radius:50%;"></div>
    </div>

    <div class="discord-card">
      <div style="display:flex; gap:20px; align-items:center;">
        <div style="width:64px; height:64px; background:rgba(255,255,255,0.2); border-radius:16px; display:flex; align-items:center; justify-content:center;">
          <i data-lucide="gamepad-2" width="32" height="32"></i>
        </div>
        <div>
          <h3 style="margin:0; font-size:24px;">EscalMc</h3>
          <div style="display:inline-flex; align-items:center; gap:6px; background:rgba(0,0,0,0.2); padding:4px 10px; border-radius:8px; font-size:12px; font-weight:700; margin-top:6px;">
            <span style="width:8px;height:8px;background:#4ade80;border-radius:50%;box-shadow:0 0 10px #4ade80;"></span>
            <span id="discord_count">Loading...</span> Online
          </div>
        </div>
      </div>
      <a href="https://discord.gg/yck3SY9W" target="_blank" class="btn-3d btn-discord" style="text-decoration:none;">Join Server</a>
    </div>
  </section>

  <aside class="sidebar-section">
    <div class="card-3d">
      <h3 style="margin-top:0;">Quick Stats</h3>
      <div style="display:flex; flex-direction:column; gap:10px;">
        <div class="stat-row">
          <div class="stat-icon" style="background:#3b82f6;"><i data-lucide="trophy" width="20"></i></div>
          <div style="flex:1;"><div style="font-weight:800;">Wins</div><div style="font-size:12px; color:#64748b;">Matches won</div></div>
          <div style="font-weight:900; font-size:18px;" id="sidebar_wins">892</div>
        </div>
        <div class="stat-row">
          <div class="stat-icon" style="background:#f97316;"><i data-lucide="crosshair" width="20"></i></div>
          <div style="flex:1;"><div style="font-weight:800;">K/D Ratio</div><div style="font-size:12px; color:#64748b;">Precision</div></div>
          <div style="font-weight:900; font-size:18px;" id="sidebar_kd">2.35</div>
        </div>
      </div>
    </div>

    <div class="bf-card">
      <h3 style="margin:0 0 10px 0; display:flex; align-items:center; gap:8px;">From Her BF <i data-lucide="heart" fill="#861e3e" width="18"></i></h3>
      <p style="background:rgba(255,255,255,0.4); padding:12px; border-radius:12px; font-size:14px; font-weight:600; line-height:1.5; margin:0;" id="disp_msg">"Tum CubeCraft ki queen ho ‚Äî main tumhara proud bf hoon."</p>
      <div style="margin-top:12px;">
        <button onclick="copyMsg()" class="btn-3d" style="background:rgba(255,255,255,0.5); font-size:12px; padding:8px 16px; color:#861e3e; width:100%;">Copy</button>
      </div>
    </div>

    <div class="card-3d">
      <h3 style="margin-top:0; display:flex; align-items:center; gap:8px;"><i data-lucide="youtube" width="20" style="color:#ff0000;"></i> Follow</h3>
      <a href="https://youtube.com/@itsmexd12?si=RhJGa73sgrpOkFX4" target="_blank" class="btn-3d btn-youtube" style="width:100%;"><i data-lucide="youtube" width="16"></i> YouTube Channel</a>
    </div>
  </aside>
</div>
</div>

<!-- Admin Modal -->
<div class="modal-overlay" id="adminModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 style="margin:0;">Admin Control</h3>
      <button onclick="closeAdmin()" style="background:none;border:none;color:white;cursor:pointer;"><i data-lucide="x"></i></button>
    </div>
    <div class="modal-body" id="loginView">
      <div style="text-align:center; padding:20px;">
        <i data-lucide="lock" width="40" height="40" style="margin-bottom:10px; color:#cbd5e1;"></i>
        <p>Enter Admin Code</p>
        <input type="password" id="adminCodeInput" class="form-input" style="text-align:center; font-size:20px; letter-spacing:4px;" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
        <button onclick="checkCode()" class="btn-3d btn-primary" style="width:100%; margin-top:20px;">Unlock</button>
      </div>
    </div>
    <div class="modal-body hidden" id="controlsView" style="max-height:70vh; overflow-y:auto;">
      <div style="background:#f1f5f9; padding:12px; border-radius:12px; display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <span style="font-weight:700;">Online Status</span>
        <button onclick="toggleOnline()" id="toggleBtn" class="btn-3d" style="background:#cbd5e1; color:#1e293b; padding:8px 16px; font-size:12px;">OFFLINE</button>
      </div>
      <div style="background:#e0f2fe; padding:12px; border-radius:12px; margin-bottom:16px; font-weight:700; color:#0369a1; font-size:12px;">üë§ BASIC INFO</div>
      <div class="input-group">
        <label>Name</label>
        <input type="text" id="edit_name" class="form-input">
      </div>
      <div class="input-group">
        <label>Gaming Username / IGN</label>
        <input type="text" id="edit_ign" class="form-input">
      </div>
      <div class="input-group">
        <label>Bio (cute 1-liner)</label>
        <input type="text" id="edit_bio" class="form-input" placeholder="CubeCraft Queen üëë">
      </div>
      <div class="input-group">
        <label>Age</label>
        <input type="number" id="edit_age" class="form-input">
      </div>
      <div class="input-group">
        <label>Streak</label>
        <input type="number" id="edit_streak" class="form-input">
      </div>
      <div class="input-group">
        <label>kd</label>
        <input type="number" id="edit_kd" class="form-input">
      </div>
      <div class="input-group">
        <label>Country / City</label>
        <input type="text" id="edit_country" class="form-input">
      </div>
      <div class="input-group">
        <label>Joined Date</label>
        <input type="date" id="edit_joinedDate" class="form-input">
      </div>
      <div style="background:#dbeafe; padding:12px; border-radius:12px; margin:20px 0 16px 0; font-weight:700; color:#1e40af; font-size:12px;">üéÆ MINECRAFT</div>
      <div class="input-group">
        <label>Edition</label>
        <select id="edit_edition" class="form-input">
          <option value="Java Edition">Java Edition</option>
          <option value="Bedrock Edition">Bedrock Edition</option>
        </select>
      </div>
      <div class="input-group">
        <label>Favorite Gamemode</label>
        <select id="edit_gamemode" class="form-input">
          <option value="Bedwars">Bedwars</option>
          <option value="Skywars">Skywars</option>
          <option value="CTF">CTF</option>
          <option value="SMP">SMP</option>
          <option value="Lifesteal">Lifesteal</option>
        </select>
      </div>
      <div class="input-group">
        <label>Favorite Server</label>
        <select id="edit_server" class="form-input">
          <option value="CubeCraft">CubeCraft</option>
          <option value="Hive">Hive</option>
          <option value="Hypixel">Hypixel</option>
          <option value="NetherGames">NetherGames</option>
        </select>
      </div>
      <div style="background:#f0fdf4; padding:12px; border-radius:12px; margin:20px 0 16px 0; font-weight:700; color:#166534; font-size:12px;">üìä GAME STATS</div>
      <div class="input-group">
        <label>Select Rank</label>
        <select id="edit_rank" class="form-input">
          <option value="Iron">Iron</option>
          <option value="Lapis">Lapis</option>
          <option value="Gold" selected>Gold</option>
          <option value="Diamond">Diamond</option>
          <option value="Emerald">Emerald</option>
          <option value="Obsidian">Obsidian</option>
        </select>
      </div>
      <div class="input-group">
        <label>Total Wins</label>
        <input type="number" id="edit_wins" class="form-input">
      </div>
      <div class="input-group">
        <label>Total Kills</label>
        <input type="number" id="edit_kills" class="form-input">
      </div>
      <div class="input-group">
        <label>Play Time (hours)</label>
        <input type="text" id="edit_playTime" class="form-input" placeholder="340 hours">
      </div>
      <div style="background:#fce7f3; padding:12px; border-radius:12px; margin:20px 0 16px 0; font-weight:700; color:#831843; font-size:12px;">‚ù§Ô∏è PERSONALITY</div>
      <div class="input-group">
        <label>Favorite Color</label>
        <input type="color" id="edit_favColor" class="form-input" style="height:44px; cursor:pointer;">
      </div>
      <div class="input-group">
        <label>Favorite Animal</label>
        <input type="text" id="edit_favAnimal" class="form-input" placeholder="Fox">
      </div>
      <div class="input-group">
        <label>Personality Type</label>
        <select id="edit_personality" class="form-input">
          <option value="Cute Gamer Girl">Cute Gamer Girl</option>
          <option value="Competitive Pro">Competitive Pro</option>
          <option value="Casual Vibe">Casual Vibe</option>
          <option value="Streamer Energy">Streamer Energy</option>
        </select>
      </div>
      <div class="input-group">
        <label>BF Message</label>
        <textarea id="edit_msg" class="form-input" rows="3"></textarea>
      </div>
      <button onclick="saveData()" class="btn-3d btn-primary" style="width:100%; margin-top:10px;">Save Changes</button>
    </div>
  </div>
</div>

<!-- Full Stats Modal -->
<div class="modal-overlay" id="fullStatsModal">
  <div class="modal-content" style="max-width:600px; max-height:80vh; overflow-y:auto;">
    <div class="modal-header">
      <h3 style="margin:0;">üìä Full Profile</h3>
      <button onclick="closeFullStats()" style="background:none; border:none; color:white; cursor:pointer;"><i data-lucide="x"></i></button>
    </div>
    <div class="modal-body">
      <div style="background:#e0f2fe; padding:12px; border-radius:12px; margin-bottom:16px; font-weight:700; color:#0369a1; font-size:12px;">üë§ BASIC INFO</div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:20px;">
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">NAME</div><div style="font-weight:800; font-size:16px;" id="stat_name">Itsme</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">USERNAME</div><div style="font-weight:800; font-size:16px;" id="stat_ign">ITSMEplays</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">BIO</div><div style="font-weight:600; font-size:14px;" id="stat_bio">CubeCraft Queen üëë</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">AGE</div><div style="font-weight:800; font-size:16px;" id="stat_age">20</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">COUNTRY</div><div style="font-weight:600; font-size:14px;" id="stat_country">India</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">JOINED</div><div style="font-weight:600; font-size:14px;" id="stat_joinedDate">2023-01-15</div></div>
      </div>

      <div style="background:#dbeafe; padding:12px; border-radius:12px; margin:20px 0 16px 0; font-weight:700; color:#1e40af; font-size:12px;">üéÆ MINECRAFT</div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:20px;">
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">EDITION</div><div style="font-weight:600; font-size:14px;" id="stat_edition">Java Edition</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">GAMEMODE</div><div style="font-weight:600; font-size:14px;" id="stat_gamemode">Bedwars</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">SERVER</div><div style="font-weight:600; font-size:14px;" id="stat_server">CubeCraft</div></div>
      </div>

      <div style="background:#f0fdf4; padding:12px; border-radius:12px; margin:20px 0 16px 0; font-weight:700; color:#166534; font-size:12px;">üìä GAME STATS</div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:20px;">
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">RANK</div><div style="font-weight:800; font-size:16px;" id="stat_rank">Gold</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">WINS</div><div style="font-weight:800; font-size:18px; color:#3b82f6;" id="stat_wins">892</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">KILLS</div><div style="font-weight:800; font-size:18px; color:#f97316;" id="stat_kills">2340</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">PLAY TIME</div><div style="font-weight:600; font-size:14px;" id="stat_playTime">340 hours</div></div>
      </div>

      <div style="background:#fce7f3; padding:12px; border-radius:12px; margin:20px 0 16px 0; font-weight:700; color:#831843; font-size:12px;">‚ù§Ô∏è PERSONALITY</div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">FAVORITE COLOR</div><div style="display:flex; align-items:center; gap:8px;"><div id="stat_favColor" style="width:32px; height:32px; background:#00a3c4; border-radius:8px; border:2px solid #e2e8f0;"></div></div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">FAVORITE ANIMAL</div><div style="font-weight:600; font-size:14px;" id="stat_favAnimal">Fox</div></div>
        <div><div style="font-size:11px; color:#64748b; font-weight:700; margin-bottom:4px;">PERSONALITY</div><div style="font-weight:600; font-size:14px;" id="stat_personality">Cute Gamer Girl</div></div>
      </div>
    </div>
  </div>
</div>

<!-- Best Clips Modal -->
<div class="modal-overlay" id="clipsModal">
  <div class="modal-content">
    <div class="modal-header" style="background:linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);">
      <h3 style="margin:0;">Best Clips</h3>
      <button onclick="closeClips()" style="background:none; border:none; color:white; cursor:pointer;"><i data-lucide="x"></i></button>
    </div>
    <div class="modal-body">
      <p>Clips coming soon...</p>
    </div>
  </div>
</div>

<script>
lucide.createIcons();

const rankColors = {
  'Iron': {color: '#e5e7eb', text: '#6b7280', bg: 'linear-gradient(135deg, #e5e7eb 0%, #d1d5db 100%)', icon: '‚¨°', shadow: 'rgba(107,112,128,0.3)'},
  'Lapis': {color: '#06b6d4', text: '#0e7490', bg: 'linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)', icon: '‚óÜ', shadow: 'rgba(6,182,212,0.3)'},
  'Gold': {color: '#fbbf24', text: '#78350f', bg: 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)', icon: '‚ñ≤', shadow: 'rgba(251,191,36,0.3)'},
  'Diamond': {color: '#3b82f6', text: '#1e40af', bg: 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)', icon: '‚óá', shadow: 'rgba(59,130,246,0.3)'},
  'Emerald': {color: '#a855f7', text: '#6b21a8', bg: 'linear-gradient(135deg, #a855f7 0%, #9333ea 100%)', icon: '‚ú¶', shadow: 'rgba(168,85,247,0.3)'},
  'Obsidian': {color: '#1e3a8a', text: '#0c1e3e', bg: 'linear-gradient(135deg, #1e3a8a 0%, #1e1b4b 100%)', icon: '‚ú¶', shadow: 'rgba(30,58,138,0.3)'}
};

const firebaseConfig = {
  apiKey: "AIzaSyA-ztUQs3lxk1NpTsUXrTQTs3MmFTFggmw",
  authDomain: "escalmc-e68f4.firebaseapp.com",
  projectId: "escalmc-e68f4",
  storageBucket: "escalmc-e68f4.firebasestorage.app",
  messagingSenderId: "905211159153",
  appId: "1:905211159153:web:6cf4e8056dbc0b7488b1d0",
  measurementId: "G-536G6R40XR"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();

const FIRESTORE_COLLECTION = 'itsmeSite';
const PROFILE_DOC_ID = 'profile';
const ADMIN_DOC_ID = 'admin';
const ADMIN_UID = 'Grazeweb12124';

const defaultProfile = {
  isOnline: false,
  name: 'Itsme',
  ign: 'ITSMEplays',
  bio: 'CubeCraft Queen üëë',
  age: 20,
  country: 'India',
  joinedDate: '2023-01-15',
  rank: 'Gold',
  edition: 'Java Edition',
  gamemode: 'Bedwars',
  server: 'CubeCraft',
  wins: 892,
  kills: 2340,
  kd: 2.35,
  streak: 12,
  playTime: '340 hours',
  favColor: '#00a3c4',
  favAnimal: 'Fox',
  personality: 'Cute Gamer Girl',
  msg: "Tum CubeCraft ki queen ho ‚Äî main tumhara proud bf hoon."
};

const defaultAdminSettings = {
  signInEmail: 'admin@itsme.app',
  loginCodeSalt: '1a2b9f4c8d1e5f6a',
  loginCodeHash: '72a4e677377d54263e8d3c07dc9ae1d10d79f7e64fc7f08758457cd2d2b7a28f'
};

let profileData = {...defaultProfile};
let adminSettings = null;
let adminUnlocked = false;

const profileRef = db.collection(FIRESTORE_COLLECTION).doc(PROFILE_DOC_ID);
const adminRef = db.collection(FIRESTORE_COLLECTION).doc(ADMIN_DOC_ID);

bootstrapRealtimeProfile();

auth.onAuthStateChanged((user) => {
  adminUnlocked = !!user && user.uid === ADMIN_UID;
  if (user && user.uid !== ADMIN_UID) {
    console.warn(`Signed in as ${user.uid}, but ADMIN_UID is ${ADMIN_UID}. Firestore rules may reject writes.`);
  }
  updateToggleBtnDisplay();
});

function openAdmin() {
  document.getElementById('adminModal').classList.add('open');
}

function closeAdmin() { 
  document.getElementById('adminModal').classList.remove('open');
  document.getElementById('loginView').classList.remove('hidden');
  document.getElementById('controlsView').classList.add('hidden');
  document.getElementById('adminCodeInput').value = '';
  adminUnlocked = false;
  if (auth.currentUser) {
    auth.signOut().catch(() => {});
  }
}

async function bootstrapRealtimeProfile() {
  try {
    adminSettings = await fetchAdminSettings();
  } catch (err) {
    console.warn('Admin settings document missing in Firestore, falling back to defaults.', err);
    adminSettings = {...defaultAdminSettings};
  }

  profileRef.onSnapshot(
    (snapshot) => {
      profileData = {...defaultProfile, ...(snapshot.exists ? snapshot.data() : {})};
      applyProfileToUI();
    },
    (error) => {
      console.error('Realtime profile error:', error);
    }
  );
}

async function fetchAdminSettings() {
  const snapshot = await adminRef.get();
  if (!snapshot.exists) {
    throw new Error('itsmeSite/admin document not found');
  }
  return {...defaultAdminSettings, ...snapshot.data()};
}

async function checkCode() {
  const input = document.getElementById('adminCodeInput');
  const code = input.value.trim();
  if (!code) {
    alert('Enter the admin code first.');
    return;
  }
  try {
    const settings = adminSettings || defaultAdminSettings;
    const hashedInput = await hashAdminCode(code, settings.loginCodeSalt || defaultAdminSettings.loginCodeSalt);
    if (hashedInput !== (settings.loginCodeHash || defaultAdminSettings.loginCodeHash)) {
      alert('‚ùå Access Denied!');
      return;
    }
    await auth.signInWithEmailAndPassword(settings.signInEmail || defaultAdminSettings.signInEmail, code);
    adminUnlocked = true;
    await ensureDefaultDocs();
    document.getElementById('loginView').classList.add('hidden');
    document.getElementById('controlsView').classList.remove('hidden');
    populateAdminForm();
    updateToggleBtnDisplay();
  } catch (error) {
    console.error('Admin login failed', error);
    alert('Unable to sign in. Make sure the Firebase Auth admin user exists and uses the admin code as its password.');
  }
}

async function hashAdminCode(code, salt) {
  const encoder = new TextEncoder();
  const data = encoder.encode(`${salt}:${code}`);
  const digest = await crypto.subtle.digest('SHA-256', data);
  return Array.from(new Uint8Array(digest)).map(b => b.toString(16).padStart(2, '0')).join('');
}

function populateAdminForm() {
  const setValue = (id, value) => {
    const el = document.getElementById(id);
    if (el) el.value = value ?? '';
  };
  setValue('edit_name', profileData.name);
  setValue('edit_ign', profileData.ign);
  setValue('edit_bio', profileData.bio);
  setValue('edit_age', profileData.age);
  setValue('edit_streak', profileData.streak);
  setValue('edit_kd', profileData.kd);
  setValue('edit_country', profileData.country);
  setValue('edit_joinedDate', profileData.joinedDate);
  setValue('edit_edition', profileData.edition);
  setValue('edit_gamemode', profileData.gamemode);
  setValue('edit_server', profileData.server);
  setValue('edit_rank', profileData.rank);
  setValue('edit_wins', profileData.wins);
  setValue('edit_kills', profileData.kills);
  setValue('edit_playTime', profileData.playTime);
  setValue('edit_favColor', profileData.favColor);
  setValue('edit_favAnimal', profileData.favAnimal);
  setValue('edit_personality', profileData.personality);
  const msgField = document.getElementById('edit_msg');
  if (msgField) msgField.value = profileData.msg ?? '';
}

function applyProfileToUI() {
  const setText = (id, value) => {
    const el = document.getElementById(id);
    if (el) el.textContent = value ?? '';
  };

  setText('disp_name', profileData.name);
  setText('disp_tag', profileData.bio);
  setText('disp_fav', profileData.gamemode);
  setText('disp_wins', profileData.wins);
  setText('disp_kd', profileData.kd);
  setText('disp_streak', profileData.streak);
  setText('sidebar_wins', profileData.wins);
  setText('sidebar_kd', profileData.kd);
  setText('disp_msg', profileData.msg);

  setText('stat_name', profileData.name);
  setText('stat_ign', profileData.ign);
  setText('stat_bio', profileData.bio);
  setText('stat_age', profileData.age);
  setText('stat_country', profileData.country);
  setText('stat_joinedDate', profileData.joinedDate);
  setText('stat_edition', profileData.edition);
  setText('stat_gamemode', profileData.gamemode);
  setText('stat_server', profileData.server);
  setText('stat_rank', profileData.rank);
  setText('stat_wins', profileData.wins);
  setText('stat_kills', profileData.kills);
  setText('stat_playTime', profileData.playTime);
  setText('stat_favAnimal', profileData.favAnimal);
  setText('stat_personality', profileData.personality);

  const favColorBlock = document.getElementById('stat_favColor');
  if (favColorBlock) favColorBlock.style.background = profileData.favColor || '#00a3c4';

  updateRankDisplay();
  setOnlinePill(profileData.isOnline);
  updateToggleBtnDisplay();
}

function updateRankDisplay() {
  const rankPill = document.getElementById('rank_pill');
  const rankCfg = rankColors[profileData.rank] || rankColors['Gold'];
  if (rankPill) {
    rankPill.style.background = rankCfg.bg;
    rankPill.style.color = rankCfg.text;
    rankPill.style.borderColor = rankCfg.color;
    rankPill.style.boxShadow = `0 4px 12px ${rankCfg.shadow}`;
  }
  const rankSpan = document.getElementById('disp_rank');
  if (rankSpan) rankSpan.textContent = `${rankCfg.icon} ${profileData.rank}`;
}

function setOnlinePill(isOnline) {
  const pill = document.getElementById('online_pill');
  if (!pill) return;
  pill.classList.toggle('online', isOnline);
  pill.classList.toggle('offline', !isOnline);
  pill.textContent = isOnline ? 'Online' : 'Offline';
}

function updateToggleBtnDisplay() {
  const btn = document.getElementById('toggleBtn');
  if (!btn) return;
  if (profileData.isOnline) {
    btn.textContent = 'ONLINE';
    btn.style.background = '#22c55e';
    btn.style.color = 'white';
  } else {
    btn.textContent = 'OFFLINE';
    btn.style.background = '#cbd5e1';
    btn.style.color = '#1e293b';
  }
  btn.disabled = !adminUnlocked;
  btn.style.opacity = adminUnlocked ? '1' : '0.7';
}

async function toggleOnline() { 
  if (!(await ensureAdminSession())) return;
  const nextState = !profileData.isOnline;
  try {
    await writeProfile({ isOnline: nextState }, { showAlert: false, shouldClose: false });
  } catch (error) {
    console.error('Online toggle failed', error);
    alert('Could not update online status. Please try again.');
  }
}

async function ensureAdminSession() {
  const user = auth.currentUser;
  if (!user) {
    adminUnlocked = false;
    alert('Admin access required. Unlock the panel first.');
    openAdmin();
    return false;
  }
  adminUnlocked = true;
  if (user.uid !== ADMIN_UID) {
    console.warn(`Signed in UID ${user.uid} does not match ADMIN_UID ${ADMIN_UID}. Update your Firebase Auth user to match the safe rules.`);
  }
  return true;
}

async function saveData() {
  if (!(await ensureAdminSession())) return;
  const updates = {
    name: document.getElementById('edit_name').value || '',
    ign: document.getElementById('edit_ign').value || '',
    bio: document.getElementById('edit_bio').value || '',
    age: document.getElementById('edit_age').value || '',
    streak: document.getElementById('edit_streak').value || '',
    kd: document.getElementById('edit_kd').value || '',
    country: document.getElementById('edit_country').value || '',
    joinedDate: document.getElementById('edit_joinedDate').value || '',
    edition: document.getElementById('edit_edition').value || '',
    gamemode: document.getElementById('edit_gamemode').value || '',
    server: document.getElementById('edit_server').value || '',
    rank: document.getElementById('edit_rank').value || '',
    wins: Number(document.getElementById('edit_wins').value) || 0,
    kills: Number(document.getElementById('edit_kills').value) || 0,
    playTime: document.getElementById('edit_playTime').value || '',
    favColor: document.getElementById('edit_favColor').value || '#00a3c4',
    favAnimal: document.getElementById('edit_favAnimal').value || '',
    personality: document.getElementById('edit_personality').value || '',
    msg: document.getElementById('edit_msg').value || ''
  };

  try {
    await writeProfile(updates);
  } catch (error) {
    console.error('Failed saving profile', error);
    alert('Saving failed. Check the console for details.');
  }
}

async function writeProfile(updates, options = {}) {
  const { showAlert = true, shouldClose = true } = options;
  const payload = {
    ...updates,
    updatedAt: firebase.firestore?.FieldValue?.serverTimestamp
      ? firebase.firestore.FieldValue.serverTimestamp()
      : new Date().toISOString()
  };
  try {
    await profileRef.set(payload, { merge: true });
    if (showAlert) alert('‚úì Saved!');
    if (shouldClose) closeAdmin();
  } catch (error) {
    console.error('Write failed', error);
    alert('Saving failed. Check Firebase rules / admin account setup.');
    throw error;
  }
}

async function ensureDefaultDocs() {
  try {
    const adminSnap = await adminRef.get();
    if (!adminSnap.exists) {
      await adminRef.set(defaultAdminSettings, { merge: true });
    }
  } catch (err) {
    console.warn('Unable to create admin settings document. Verify Firestore rules.', err);
  }

  try {
    const profileSnap = await profileRef.get();
    if (!profileSnap.exists) {
      await profileRef.set(defaultProfile, { merge: true });
    }
  } catch (err) {
    console.warn('Unable to create profile document. Verify Firestore rules.', err);
  }
}

function openFullStats() { document.getElementById('fullStatsModal').classList.add('open'); }
function closeFullStats() { document.getElementById('fullStatsModal').classList.remove('open'); }
function openClips() { document.getElementById('clipsModal').classList.add('open'); }
function closeClips() { document.getElementById('clipsModal').classList.remove('open'); }

function copyMsg() {
  navigator.clipboard.writeText(profileData.msg || '').then(() => {
    alert('‚úì Copied!');
  }).catch(() => alert('Copy failed'));
}

document.getElementById('adminModal').addEventListener('click', (e) => {
  if (e.target === document.getElementById('adminModal')) closeAdmin();
});

fetch('https://discord.com/api/guilds/1420001537429868676/widget.json')
  .then(res => res.json())
  .then(d => { document.getElementById('discord_count').textContent = d.presence_count || 0; })
  .catch(() => { document.getElementById('discord_count').textContent = '0'; });
</script>
</body>
</html>
